<?xml version="1.0"?>
<!-- **********************************************************************-->
<!-- Copyright 2012-2025                                                   -->
<!-- Matthew Boelkins                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Calculus.                                 -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->

<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-7-3-euler">
  <title>Euler's method</title>
  <objectives>
    <ul>
      <li>
        <p>
          What is Euler's method and how can we use it to approximate the solution to an initial value problem?
        </p>
      </li>

      <li>
        <p>
          How accurate is Euler's method?
        </p>
      </li>
    </ul>
  </objectives>

  <subsection><title>Introduction</title>
    <p>
      In <xref ref="sec-7-2-qualitative">Section</xref>,
      we saw how a slope field can be used to sketch solutions to a differential equation.
      In particular,
      the slope field is a plot of a large collection of tangent lines to a large number of solutions of the differential equation,
      and we sketch a single solution by simply following these tangent lines.
      With a little more care,
      we can use this same idea to approximate numerically the solutions of a differential equation.
    </p>

    <xi:include href="./previews/PA-7-3-WW.xml" />
    <xi:include href="./previews/PA-7-3.xml" />
  </subsection>

  <subsection>
    <title>Euler's Method</title>
    <idx><h>Euler's Method</h></idx>

    <p>
      <xref ref="PA-7-3">Preview Activity</xref>
      demonstrates an algorithm known as Euler's<fn>
      <q>Euler</q> is pronounced <q>Oy-ler.</q>
      Among other things, Euler is the mathematician credited with the famous number <m>e</m>;
      if you incorrectly pronounce his name <q>You-ler,</q>
      you fail to appreciate his genius and legacy.
      </fn> Method,
      which generates a numerical approximation to the solution of an initial value problem.
      In this algorithm,
      we will approximate the solution by taking horizontal steps of a fixed size that we denote by <m>\Delta t</m>.
    </p>

    <sidebyside widths="47% 47%" margins="0%" valign="middle">

      <stack>
        <p>
          Before explaining the algorithm in detail,
          let's remember how we compute the slope of a line:
          the slope of a given line is the ratio of the vertical change to the horizontal change,
          as shown in <xref ref="F-7-3-slope">Figure</xref>.
        </p>

        <p>
          In symbols, <m>m = \frac{\Delta y}{\Delta t}</m>.
          Solving for <m>\Delta y</m>, we see that the
          vertical change is the product of the slope and the horizontal change, or
          <me>
            \Delta y = m\Delta t
          </me>.
        </p>

        <p>
          In words, this says that (along a line), the change in <m>y</m> between two points is the product of the slope times the change in <m>x</m>.
        </p>
      </stack>

      <figure xml:id="F-7-3-slope">
        <caption>Visualizing slope.</caption>
        <image source="images/7_3_slope"/>
      </figure>
    </sidebyside>

    <p>
      Now, suppose that we would like to solve the initial value problem
      <me>
        \frac{dy}{dt} = t - y, \ y(0) = 1
      </me>.
    </p>

    <p>
      Using more advanced techniques from differential equations, it's possible to find an algebraic formula for the solution to this initial value problem,
      and we can check that this solution is <m>y(t) = t -1 + 2e^{-t}</m>.
      Here we are instead interested in generating an approximate solution by creating a sequence of points <m>(t_i, y_i)</m>,
      where <m>y_i\approx y(t_i)</m>, but we'll use the algebraic formula as a way to check the accuracy of our approximation.
    </p>

    <p>
      For this first example, we choose <m>\Delta t = 0.2</m>.  Since we know that <m>y(0) = 1</m>,
      we will take the initial point to be
      <m>(t_0,y_0) = (0,1)</m> and move horizontally by <m>\Delta t = 0.2</m> to the
      point <m>(t_1,y_1)</m>.
      Thus, <m>t_1=t_0+\Delta t = 0.2</m>.
      Now, the differential equation tells us that the slope of the
      tangent line at this point is
      <me>
        m=\frac{dy}{dt}\bigg\vert_{(0,1)} = 0-1 = -1
      </me>,
    </p>

    <sidebyside widths="50% 44%" margins="0%" valign="middle">
      <p>
        so to move along the tangent line by taking a horizontal step of size <m>\Delta t=0.2</m>,
        we must also move vertically by
        <me>
          \Delta y = m\Delta t = -1\cdot 0.2 = -0.2
        </me>.
        We then have the approximation 
        <me>
          y(0.2) \approx y_1= y_0 + \Delta y = 1 - 0.2 = 0.8
        </me>.
        At this point, we have executed one step of Euler's method,
        as seen graphically in <xref ref="F-7-3-euler-points-1">Figure</xref>.
      </p>

      <figure xml:id="F-7-3-euler-points-1">
        <caption>One step of Euler's method.</caption>
        <image source="images/7_3_euler_points_1"/>
      </figure>
    </sidebyside>

    <p>
      Now we repeat this process:
      at <m>(t_1,y_1) = (0.2,0.8)</m>, the
      differential equation tells us that the slope is
      <me>
        m=\frac{dy}{dt}\bigg\vert_{(0.2,0.8)} = 0.2-0.8 = -0.6
      </me>.
    </p>

    <sidebyside widths="50% 44%" margins="0%" valign="middle">
      <p>
        Since we are moving forward horizontally by
        <m>\Delta t</m> to <m>t_2=t_1+\Delta t = 0.4</m>,
        we must move vertically by
        <me>
          \Delta y = m \cdot \Delta t = -0.6\cdot0.2 = -0.12
        </me>.
        We consequently arrive at 
        <me>
          y_2 = y_1 + \Delta y = 0.8-0.12 = 0.68
        </me>,
        which gives <m>y(0.2)\approx 0.68</m>.
        Now we have completed the second step of Euler's method,
        as shown in <xref ref="F-7-3-euler-points-2">Figure</xref>.
      </p>

      <figure xml:id="F-7-3-euler-points-2">
        <caption>Two steps of Euler's method.</caption>
        <image source="images/7_3_euler_points_2"/>
      </figure>
    </sidebyside>

    <p>
      If we continue in this way,
      we may generate the points
      <m>(t_i, y_i)</m> shown in <xref ref="F-7-3-Euler-Pts-a">Figure</xref>.
      Because it turns out that the exact to this differential equation is <m>y(t) = t -1 + 2e^{-t}</m>,
      we can graph <m>y(t)</m> and compare it to the points generated by Euler's method,
      as shown in <xref ref="F-7-3-Euler-Pts-b">Figure</xref>.
    </p>

    <sidebyside widths="47% 47%" margins="0%">
      <figure xml:id="F-7-3-Euler-Pts-a">
        <caption>The points and piecewise linear approximate solution generated by Euler's method.</caption>
        <image width="80%" source="images/7_3_euler_points_6">
        </image>

      </figure>

      <figure xml:id="F-7-3-Euler-Pts-b">
        <caption>The approximate solution compared to the exact solution (shown in blue).</caption>
        <image width="80%" source="images/7_3_euler">
        </image>

      </figure>
    </sidebyside>

    <p>
      Because we need to generate a large number of points <m>(t_i,y_i)</m>,
      it is convenient to organize the implementation of Euler's method in a table.
      We begin with the given initial data, as shown in <xref ref="T-7-3-euler-initial">Table</xref>.
    </p>

    <sidebyside widths="47% 47%">

    <table xml:id="T-7-3-euler-initial">
      <title>Starting with given initial data.</title>
      <tabular top="minor" bottom="minor">
        <row>
          <cell><m>t_i</m></cell>
          <cell><m>y_i</m></cell>
          <cell><m>dy/dt</m></cell>
          <cell><m>\Delta y</m></cell>
        </row>
        <row>
          <cell><m>0.0</m></cell>
          <cell><m>1.0000</m></cell>
          <cell/>
          <cell/>
        </row>
      </tabular>
    </table> 

    <table xml:id="T-7-3-euler-one-step">
      <title>The first values of <m>dy/dt</m> and <m>\Delta y</m>.</title>
      <tabular top="minor" bottom="minor">
        <row>
          <cell><m>t_i</m></cell>
          <cell><m>y_i</m></cell>
          <cell><m>dy/dt</m></cell>
          <cell><m>\Delta y</m></cell>
        </row>
        <row>
          <cell><m>0.0</m></cell>
          <cell><m>1.0000</m></cell>
          <cell><m>-1.0000</m></cell>
          <cell><m>-0.2000</m></cell>
        </row>
      </tabular>
    </table>
    </sidebyside>

    <p>
      From here, we compute the slope of the tangent line <m>m=dy/dt</m> using the formula for <m>dy/dt</m> from the differential equation,
      and then we find <m>\Delta y</m>,
      the change in <m>y</m>, using the rule <m>\Delta y = m\Delta t</m>.  These two results are shown in the last two columns of <xref ref="T-7-3-euler-one-step">Table</xref>.
    </p>

    <p>
      Next, we increase <m>t_i</m> by
      <m>\Delta t</m> and <m>y_i</m> by <m>\Delta y</m> to get the start of the second row in <xref ref="T-7-3-euler-second-step">Table</xref>.
    </p>

    <sidebyside widths="44% 44%">

      <table xml:id="T-7-3-euler-second-step">
        <title>Starting the second step of Euler's Method.</title>
          <tabular top="minor" bottom="minor">
            <row>
              <cell><m>t_i</m></cell>
              <cell><m>y_i</m></cell>
              <cell><m>dy/dt</m></cell>
              <cell><m>\Delta y</m></cell>
            </row>
            <row>
              <cell><m>0.0</m></cell>
              <cell><m>1.0000</m></cell>
              <cell><m>-1.0000</m></cell>
              <cell><m>-0.2000</m></cell>
            </row>
            <row>
              <cell><m>0.2</m></cell>
              <cell><m>0.8000</m></cell>
              <cell/>
              <cell/>
            </row>
          </tabular>
      </table>

          <table xml:id="T-7-3-Example">
      <title>Euler's method for 6 steps with <m>\Delta t = 0.2</m>.</title>
      <tabular top="minor" bottom="minor">
        <row>
          <cell><m>t_i</m></cell>
          <cell><m>y_i</m></cell>
          <cell><m>dy/dt</m></cell>
          <cell><m>\Delta y</m></cell>
        </row>
        <row>
          <cell><m>0.0</m></cell>
          <cell><m>1.0000</m></cell>
          <cell><m>-1.0000</m></cell>
          <cell><m>-0.2000</m></cell>
        </row>
        <row>
          <cell><m>0.2</m></cell>
          <cell><m>0.8000</m></cell>
          <cell><m>-0.6000</m></cell>
          <cell><m>-0.1200</m></cell>
        </row>
        <row>
          <cell><m>0.4</m></cell>
          <cell><m>0.6800</m></cell>
          <cell><m>-0.2800</m></cell>
          <cell><m>-0.0560</m></cell>
        </row>
        <row>
          <cell><m>0.6</m></cell>
          <cell><m>0.6240</m></cell>
          <cell><m>-0.0240</m></cell>
          <cell><m>-0.0048</m></cell>
        </row>
        <row>
          <cell><m>0.8</m></cell>
          <cell><m>0.6192</m></cell>
          <cell><m>0.1808</m></cell>
          <cell><m>0.0362</m></cell>
        </row>
        <row>
          <cell><m>1.0</m></cell>
          <cell><m>0.6554</m></cell>
          <cell><m>0.3446</m></cell>
          <cell><m>0.0689</m></cell>
        </row>
        <row>
          <cell><m>1.2</m></cell>
          <cell><m>0.7243</m></cell>
          <cell><m>0.4757</m></cell>
          <cell><m>0.0951</m></cell>
        </row>
      </tabular>
    </table>

    </sidebyside>

    <p>
      We can continue the process for however many steps we decide,
      eventually generating a table like <xref ref="T-7-3-Example">Table</xref>, which is the full set of data needed to generate <xref ref="F-7-3-Euler-Pts-a">Figure</xref>.
    </p>

    <p>
      Overall, we have developed the following general approach that is known as Euler's Method.
    </p>

    <assemblage xml:id="asm-Euler">
      <title>Euler's Method</title>
      <p>
        Given an initial value problem of the form <m>\frac{dy}{dt} = f(t, y), \text{  } y(t_0) = y_0</m>, we can generate a collection of approximations <m>y_1, y_2, \ldots</m> to the values of <m>y(t_1), y(t_2), \ldots</m> using the following algorithm:
        <ul>
          <li>
            <p>
              Choose a value for <m>\Delta t</m>
            </p>
          </li>
          <li>
            <p>
              Set <m>y_0 = y(t_0)</m>
            </p>
          </li>
          <li>
            <p>
              For each desired natural number <m>i</m>, set <m>t_{i+1} = t_i + \Delta t</m> and
              <me>
                 y_{i+1} = y_i + f(t_i, y_i) \Delta y
              </me> 
            </p>
          </li>
        </ul>        
      </p>
    </assemblage>

    <p>
      The notation <m>\frac{dy}{dt} = f(t, y)</m> just means <q><m>\frac{dy}{dt}</m> depends on <m>y</m> and/or <m>t</m> in the way described by the given differential equation</q>.  We have worked most recently with <m>\frac{dy}{dt} = t - y</m>, and the formula <m>f(t,y) = t - y</m> was used every time we needed to find the slope at the next point.
    </p>

    <xi:include href="./activities/act-7-3-1.xml"/>

    <xi:include href="./activities/act-7-3-2.xml"/>

  </subsection>

  <subsection>
    <title>The error in Euler's method</title>
    <idx><h>Euler's Method</h><h>error</h></idx>

    <p>
      Since we are approximating the solutions to an initial value problem
      using tangent lines, we should expect that the error in the
      approximation will be smaller when the step size is smaller.
      Consider the initial value problem
      <me>
        \frac{dy}{dt} = y, \ y(0) = 1
      </me>,
      whose solution we can easily find.
    </p>

    <p>
      The question posed by this initial value problem is
      <q>what function do we know that is the same as its own derivative and has value 1 when <m>t=0</m>?</q>
      Observe that the solution is <m>y(t) = e^t</m>.
      We now apply Euler's method to approximate
      <m>y(1) = e</m> using several values of <m>\Delta t</m>.
      These approximations will be denoted by <m>E_{\Delta t}</m>,
      and we'll use them to see how accurate Euler's Method is.
    </p>

    <p>
      To begin, we apply Euler's method with a step size of <m>\Delta t =
      0.2</m>.
      In that case, we find that <m>y(1) \approx E_{0.2} = 2.4883</m>.
      The
      error is therefore
      <me>
        y(1) - E_{0.2} = e - 2.4883 \approx 0.2300
      </me>.
    </p>

    <p>
      Repeatedly halving <m>\Delta t</m> gives the following results,
      expressed in both tabular and graphical form.
    </p>

    <sidebyside widths="47% 47%" margins="0%" valign="middle">

      <table>
        <title>Errors that correspond to different <m>\Delta t</m> values.</title>
        <tabular top="minor">
          <row bottom="minor">
            <cell><m>\Delta t</m></cell>
            <cell><m>E_{\Delta t}</m></cell>
            <cell>Error</cell>
          </row>
          <row>
            <cell><m>0.200</m></cell>
            <cell><m>2.4883</m></cell>
            <cell><m>0.2300</m></cell>
          </row>
          <row>
            <cell><m>0.100</m></cell>
            <cell><m>2.5937</m></cell>
            <cell><m>0.1245</m></cell>
          </row>
          <row>
            <cell><m>0.050</m></cell>
            <cell><m>2.6533</m></cell>
            <cell><m>0.0650</m></cell>
          </row>
          <row bottom="minor">
            <cell><m>0.025</m></cell>
            <cell><m>2.6851</m></cell>
            <cell><m>0.0332</m></cell>
          </row>
        </tabular>

      </table>

      <figure>
        <caption>A plot of the error as a function of <m>\Delta t</m>.</caption>
        <image source="images/7_3_error"/>
      </figure>
    </sidebyside>

    <p>
      Notice, both numerically and graphically,
      that the error is roughly halved when <m>\Delta t</m> is halved.
      This example illustrates the following general principle.
    </p>

    <p>
      If Euler's method is used to approximate the solution to an initial
      value problem at a point <m>\overline{t}</m>, then the error is
      proportional to <m>\Delta t</m>.
      That is,
      <me>
        y(\overline{t}) - E_{\Delta t} \approx K\Delta t
      </me>
      for some constant of proportionality <m>K</m>.
    </p>
  </subsection>

  <subsection>
    <title>Summary</title>
    <p>
      <ul>
        <li>
          <p>
            Euler's method is an algorithm for approximating the solution to an initial value problem by following the tangent lines while we take horizontal steps across the <m>t</m>-axis.
          </p>
        </li>

        <li>
          <p>
            If we wish to approximate <m>y(\overline{t})</m> for some fixed
            <m>\overline{t}</m> by taking horizontal steps of size <m>\Delta t</m>,
            then the error in our approximation is proportional to <m>\Delta t</m>.
          </p>
        </li>
      </ul>
    </p>
  </subsection>

  <xi:include href="./exercises/ez-7-3.xml"/>
</section>
